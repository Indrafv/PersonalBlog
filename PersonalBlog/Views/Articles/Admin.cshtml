@model List<PersonalBlog.Models.Articles>;
@using System.Security.Claims;

@{
    ViewData["Title"] = "Admin Panel";
}

<div class="row mb-4 pt-3">
    <div class="col-12 d-flex justify-content-between align-items-center">
        <div>
            @if (User.Identity!.IsAuthenticated)
            {
                <h2 class="fw-bold mb-1">
                    Welcome, <span class="text-gradient">@User.Claims.Where(c => c.Type == ClaimTypes.Name).Select(c => c.Value).SingleOrDefault()</span>
                </h2>
            }
            <p class="text-muted mb-0">Manage your articles and content from here.</p>
        </div>
        <a asp-controller="Articles" asp-action="New" class="btn btn-primary rounded-pill px-4 hover-lift">
            <i class="fa-solid fa-plus me-2"></i>New Article
        </a>
    </div>
</div>

<div class="card border-0 rounded-4 custom-shadow glass-navbar overflow-hidden">
    <div class="card-body p-0">
        <div class="table-responsive">
            <table class="table table-hover align-middle mb-0">
                <thead class="bg-light bg-opacity-50">
                    <tr>
                        <th class="ps-4 py-3 text-muted fw-semibold border-bottom-0">Article Title</th>
                        <th class="py-3 text-muted fw-semibold border-bottom-0 text-end pe-4">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @if (Model != null && Model.Any())
                    {
                        @foreach (var article in Model)
                        {
                            <tr>
                                <td class="ps-4 py-3 border-subtle">
                                    <div class="fw-medium text-dark">@article.Title</div>
                                </td>
                                <td class="py-3 pe-4 text-end border-subtle">
                                    <div class="d-flex justify-content-end gap-2">
                                        <a asp-controller="Articles" asp-action="Edit" asp-route-id="@article.ArticleId" 
                                           class="btn btn-sm btn-outline-primary rounded-pill px-3 transition-all">
                                           <i class="fa-solid fa-pen-to-square me-1"></i>Edit
                                        </a>
                                        <a asp-controller="Articles" asp-action="Delete" asp-route-id="@article.ArticleId" 
                                           onclick="return confirmar()" 
                                           class="btn btn-sm btn-outline-danger rounded-pill px-3 transition-all">
                                           <i class="fa-regular fa-trash-can me-1"></i>Delete
                                        </a>
                                    </div>
                                </td>
                            </tr>
                        }
                    }
                    else
                    {
                        <tr>
                            <td colspan="2" class="text-center py-5 text-muted border-subtle">
                                <i class="fa-solid fa-file-circle-xmark fa-2x mb-2 text-light"></i>
                                <p class="mb-0">No articles found in the database.</p>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>

@section Scripts{
    <script>
        function confirmar() {
            return confirm("Are you sure you want to delete this article? This action cannot be undone.");
        }
    </script>
}